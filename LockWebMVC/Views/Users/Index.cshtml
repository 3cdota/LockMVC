@model IEnumerable<LockWebMVC.User>
@using PagedList.Mvc;
@using PagedList;

@{
    ViewBag.Title = "Index";
    var pagedlist = (IPagedList)Model;
    List<Department> departments = ViewBag.DepartmentList;
}
<div class="row" style="margin-top:8px">

    <div class="col-md-2" style="border:2px solid #18bc9c">

        <ul class="nav nav-pills nav-stacked">
            <li role="presentation"><a href="/Users/index">全部用户<span class="badge">@ViewBag.TotalCount</span></a><hr /> </li>

            @foreach (var item in departments)
            {
                <li role="presentation"><a href="/Users/index?DID=@item.ID">@item.DepartmentName<span class="badge">@item.Users.Count</span></a> </li>

            }

        </ul>

    </div>
    <div class="col-md-10">
        <h2></h2>


        @using (Html.BeginForm("Index", "Users", FormMethod.Get))
        {
            <p>
                <div class="form-inline">

                    <div class="form-group">
                        @Html.Hidden("DID", ViewBag.DID as String)

                        @Html.TextBox("SearchString", ViewBag.SearchString as string, new { @class = "form-control", @style = "width:850px" })
                    </div>


                    <input type="submit" value="搜索" class="btn btn-danger" />

                </div>
            </p>

        }

        <p>
             @*@Html.ActionLink("Create New", "Create")*@

            <table class="table">
                <tr class="warning">
                    <th>
                        序号
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Name)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Department1.DepartmentName)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.SpecificDepartment)
                    </th>


                    <th>
                        @Html.DisplayNameFor(model => model.Approved)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.AuthType1.AuthName)
                    </th>
                    <th></th>
                </tr>

                @{ int i = 1; }
                @foreach (var item in Model)
                {
                    var color = "";
                    var tdcolor = "";
                    switch (i % 2)
                    {
                        case 1:
                            color = "info";
                            break;
                        case 0:
                            color = "success";
                            break;
                    }
                    if (!item.Approved)
                    {
                        tdcolor = "danger";
                    }
                    <tr class=@color>
                        <td >
                            @(i++)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Department1.DepartmentName)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.SpecificDepartment)
                        </td>



                        <td >
                            @Html.DisplayFor(modelItem => item.Approved)
                        </td>

                        <td>
                            @Html.DisplayFor(modelItem => item.AuthType1.AuthName)
                        </td>
                        <td>
                            @Html.ActionLink("批准", "Edit", new { id = item.ID }) |
                            @Html.ActionLink("详细", "Details", new { id = item.ID }) |
                            @Html.ActionLink("删除", "Delete", new { id = item.ID })
                        </td>
                    </tr>
                }

            </table>

            共 @pagedlist.TotalItemCount 项 ，Page @(pagedlist.PageCount < pagedlist.PageNumber ? 0 : pagedlist.PageNumber) of @pagedlist.PageCount
            @Html.PagedListPager(pagedlist, page => Url.Action("Index",
             new
             {
                 page = page,
                 PageSize = ViewBag.PageSize,
                 SearchString = ViewBag.SearchString,
                 DID=ViewBag.DID,
               
            }))

    </div>
</div>
